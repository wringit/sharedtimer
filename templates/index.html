<!DOCTYPE html>
<html>
    <head>
        <!--NOTE: STYLESHEET BY GITHUB COPILOT-->
        <style>
            
           /* body {
                font-family: Arial, sans-serif;
                background-color: #f9f9f9;
                color: #333;
                text-align: center;
                padding: 20px;
            }

            #preTimer input,
            #timerContent input {
                padding: 10px 20px;
                margin: 10px;
  border: 1px solid #ccc;
  background-color: white;
  cursor: pointer;
}

#timerContent {
  margin-top: 30px;
}

#timerText {
  font-size: 2em;
  margin-bottom: 10px;
}

#code {
  font-size: 1.2em;
  color: #666;
}
*/
/*
body {
  font-family: 'Segoe UI', sans-serif;
  background-color: #121212;
  color: #e0e0e0;
  text-align: center;
  padding: 20px;
}

#preTimer input,
#timerContent input {
  padding: 10px 20px;
  margin: 10px;
  border: none;
  background-color: #333;
  color: #e0e0e0;
  cursor: pointer;
}

#preTimer input:hover,
#timerContent input:hover {
  background-color: #444;
}

#timerContent {
  margin-top: 30px;
}

#timerText {
  font-size: 2em;
  color: #ff9800;
}

#code {
  font-size: 1.2em;
  color: #bbb;
}*//*
            body {
  font-family: 'Courier New', monospace;
  background-color: #000;
  color: #0f0;
  text-align: center;
  padding: 20px;
}

#preTimer input,
#timerContent input {
  padding: 10px 20px;
  margin: 10px;
  border: 2px solid #0f0;
  background-color: transparent;
  color: #0f0;
  cursor: pointer;
  text-shadow: 0 0 5px #0f0;
}

#preTimer input:hover,
#timerContent input:hover {
  background-color: #0f0;
  color: #000;
}

#timerContent {
  margin-top: 30px;
}

#timerText {
  font-size: 2em;
  text-shadow: 0 0 10px #0f0;
}

#code {
  font-size: 1.2em;
  text-shadow: 0 0 5px #0f0;
}*/

body {
  font-family: 'Comic Sans MS', cursive;
  background-color: #fff0f5;
  color: #5a5a5a;
  text-align: center;
  padding: 20px;
}

#preTimer input,
#timerContent input {
  padding: 10px 20px;
  margin: 10px;
  border: none;
  background-color: #ffe4e1;
  color: #5a5a5a;
  cursor: pointer;
  border-radius: 10px;
  box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
}

#preTimer input:hover,
#timerContent input:hover {
  background-color: #ffb6c1;
}

#timerContent {
  margin-top: 30px;
}

#timerText {
  font-size: 2em;
  color: #db7093;
}

#code {
  font-size: 1.2em;
  color: #8b008b;
}
  
        </style>
    </head>
    <body>
        <div id="preTimer">
            <input type="button" value="New timer" onclick="newTimer();">
            <input type="button" value="Join timer" onclick="joinTimer();">
        </div>
        <div id="timerContent">
            <h1 id="timerText"></h1>
            <p id="code"></p>
            <input type = "button" value="Pause" id="pause" onclick="pauseTimer();">
            <input type = "button" value = "Stop">
        </div>
        <script>
            document.getElementById('timerContent').style.display = 'none';
            // When "new timer" is pressed, create alert that asks user for number of seconds
            // Take in that number and send POST request to create new timer (/timer)
            // If "join timer", alert should ask for code
            // If it doesn't work, call ask function again
            let globalCode;
            // Hide new/join timer buttons
            // send GET request every eighth of a second to /timer/get to get current time
            // Update timerText with that
            function newTimer() {
                let time = prompt("Enter time in seconds.");
                let code = createTimer(time);
                if (code !== "") {
                    runTimer(code);
                } else {
                    alert("Invalid time");
                }
            }
            function joinTimer() {
                let code = prompt("Enter code for timer");
                let timer = runTimer(code);
                if (timer == "error") {
                    alert("Invalid code");

                }
            }
            function pauseTimer() {
                document.getElementById("pause").value = "Unpause"
                const xhttp = new XMLHttpRequest();
                xhttp.onload = function() {
                    runTimer(this.responseText)
                }
                xhttp.open("POST","/timerCodes/"+globalCode, true);
                xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhttp.send("action=PAUSE");
            }
            function createTimer(time) {
                if (isNaN(time) || time.includes(".")) {
                    return "";
                } else {
                    const xhttp = new XMLHttpRequest();
                    let code;
                    xhttp.onload = function() {
                        globalCode = this.responseText
                        runTimer(this.responseText)
                    }
                    xhttp.open("POST","/create", true);
                    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                    xhttp.send("time="+time);
                    return code;
                }
            }
            function runTimer(code) {
                document.getElementById('timerContent').style.display = 'initial';
                document.getElementById('preTimer').style.display = 'none';
                document.getElementById('code').innerText = code;
                let update = setInterval(updateTimer,250,[code]);
                //document.getElementById("code").innerText = code;
            }
            function updateTimer(code) {
                const xhttp = new XMLHttpRequest();
                xhttp.onload=function() {
                    if (!this.responseText.includes(" ") || this.responseText.includes("error")) {
                        document.getElementById('timerText').innerText = this.responseText;
                    }
                }
                xhttp.open("GET", "/timerCodes/"+code);
                xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhttp.send();
            }

        </script>
    </body>
</html>